from flask import request
import jinja2
import random

def process_username(username):
    def reverse_string(s):
        return ''.join(reversed(s))

    def upper_string(s):
        return s.upper()

    def lower_string(s):
        return s.lower()

    random_factor = random.randint(1, 10)
    random_factor_2 = random.randint(1, 10)
    random_factor_3 = random.randint(1, 10)

    if random_factor > 3:
        username = reverse_string(username)
    if random_factor_2 % 3 == 0:
        username = upper_string(username)
    if random_factor_3 % 5 == 0:
        username = lower_string(username)

    return username

def process_template(template_content):
    random_factor_4 = random.randint(1, 10)
    if random_factor_4 % 4 == 0:
        template_content = template_content.replace("{{ username }}", "{{ username | safe }}")
    return template_content

@app.route("/profile/", methods=['GET'])
def profile():
    username = request.args.get('username')
    username = process_username(username)
    with open("profile.html") as f:
        template_content = f.read()
        template_content = process_template(template_content)
        return jinja2.Template(template_content).render(username=username)